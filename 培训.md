

# Linux计划任务

## 轮询计划任务

> <h3>分为两种:用户级别和系统级别

### 用户模式下编辑：

### 编辑：

```
crontab -e   \\进入编辑
```
```
*/(分钟)、(小时)、(日期)、(月)、(周) (commend命令)
*/ 02     18      *      *    5    echo “66666”> /dev/pts/0(发送到前端）     \\分钟代码中也可使用 2,30 表示 表示 2分钟一次 2分30秒一次
```

### 查询:

```
 crontab -1
```
### 删除：

```
crontab -r    \\代码意思为全删  如果要删除特定要进入代码中一条一条删  
```
轮询代码原理类似于 定闹钟 一周响5此

在linux中定期轮询时间最短为1分钟

---

## 系统级别为：

存在于系统文件中的配置文件。查看自己系统文件的位置，可以直接把写好的配置文件放进去他就会自己执行轮询。

---

## 特殊计划任务 
> 类似于 机房停电 定时关机 
> 例行性的备份 只出发一次性的任务

###  绝对时间

```linux
at HH:MM: YYYY-MM-DD
at 17:20 2019-07-20 --绝对时间

```

### 相对时间

```
at now + (小时) /（分钟）
```
### 示例：
```
at now + 1 minutes
at> echo "666"
at> <EOT> （ctrl +D 结束）
JOB 20 at yyyy-mm-dd 
```
查询：
```
atq
```

>查看发送给是：
who  --他会发送到终端的名称<br>

你需要**重定向**到你需要的地方:符合为：">"
```linux
at> echo "adsadadad" >/dev/pts/0
```

>也可以用于创建文件：
```
at -d
at> "adsdsa.txt" /dev/pet/xxx/xxx
```
---

## 对于长ping 使用重定向符号

Linux中如果ping就会一直ping 在30 分钟长ping不能断。

## 第一种方法：

创建一个保存ping的文件
```
ping 114.114.114.114 > ./ping.txt
```
>保存到./ping.txt 文件中并查看:
```
cat ping.txt
```
![](img/3.png)
![](img/4.png)

## 第二种 放到背景情况下执行

如果要同时执行ping并且拷贝任务

```
mv(拷贝) Oraacle.xxxxxxx.zip ../../../zip/  &  \\放到背景运行符
```

## 举例： 
```
ping 114.114.114.114 >./ ping.txt &
```
现在任务已经到后台了，那么如何查看呢：
```
jobs      \\查看当前所有进程

jobs -r   \\查看run状态的进程

jobs -s   \\ 查看stop状态的进程
```
![](img/2.png)

## 运行背景中的进程

切换后台的运行状态 不会运行到前景。
```
bg %(进程号)
```

## 把后台的命令调到前台

```
fg %(进程号)
```
![](img/5.png)

---

##  使用系统级别的调用  

```
nohup xxxx
 了解就行
```

---

# Linux 操作系统使用

><h2> 常见的DNS的配置,网站的安装-apache等等。
</h2>

## 查看当前程序运行状态

```
netstat -tnlp   \\查看所有运行中的连接配置
netstat -tnp    \\查看当前运行的连接配置
```
![](img/6.png)
![](img/7.png)

---

##  查看父程序的代码

### 查看shell  类似于任务管理器

```
ps -l       \\当前程序进程
ps -lef     \\当前系统进程
pstree      \\当前进程树
```

![](img/10.png)

![](img/9.png)

![](img/8.png)
查看代码 PID 和 PPID

![](img/1.png)

>在图中可知 第二项的PPID为4457   第一项的PID为4457  
说明第一项是第二项的父程序 

### 用处：

<h3>如果说一些程序，进程关闭不掉时 说明有父程序在调用。查询之后查看父id连父ID一起关闭。
</h3>

关闭进程：

```
kill -9 (进程号)  \\强制直接杀完不保存
kill -15 (进程号) \\保存并退出
kill -l    \\查看所有推出方式
```
---

## 监控Linux系统状况
 top命令是用来监控Linux系统状况，比如cpu、内存的使用。 默认为5秒一次刷新 
```
top  
top -1   \\一秒刷新一次

```

### 常用代码

Ctrl+L：擦除并且重写屏幕

K：终止一个进程。系统将提示用户输入需要终止的进程PID，以及需要发送给该进程什么样的信号。一般的终止进程可以使用15信号；如果不能正常结束那就使用信号9强制结束该进程。默认值是信号15。在安全模式中此命令被屏蔽。

i：忽略闲置和僵死进程。这是一个开关式命令。

q：退出程序

r:重新安排一个进程的优先级别。系统提示用户输入需要改变的进程PID以及需要设置的进程优先级值。输入一个正值将使优先级降低，反之则可以使该进程拥有更高的优先权。默认值是10。

S：切换到累计模式。

s：改变两次刷新之间的延迟时间。系统将提示用户输入新的时间，单位为s。如果有小数，就换算成m s。输入0值则系统将不断刷新，默认值是5 s。需要注意的是如果设置太小的时间，很可能会引起不断刷新，从而根本来不及看清显示的情况，而且系统负载也会大大增加。

f或者F：从当前显示中添加或者删除项目。

o或者O：改变显示项目的顺序

l：切换显示平均负载和启动时间信息。

m:切换显示内存信息。

t:切换显示进程和CPU状态信息。

c:切换显示命令名称和完整命令行。

M:根据驻留内存大小进行排序。

P:根据CPU使用百分比大小进行排序。

T:根据时间/累计时间进行排序。

W:将当前设置写入~/.toprc文件中。




## 查看当前系统的版本

```
uname -a
```
![](img/12.png)

```
lsb_release -a    \\查看当前版本
```
![](img/13.png)

### 查看当前的架构 比如 kali ，ubuntu等等
```
cat /etc/redhat-release
```

### 查看当前运行的磁盘读写速率 占用情况

```
ss -lt   \\查看当前磁盘读写的情况于速率
ss -ltn
```
![](img/14.png)

---

## 显示所有设备负载情况

```

iostat

iostat -d  

```
![](img/15.png)

### 说明：

- pu属性值说明：

- %user：CPU处在用户模式下的时间百分比。

- %nice：CPU处在带NICE值的用户模式下的时间百分比。

- %system：CPU处在系统模式下的时间百分比。

- %iowait：CPU等待输入输出完成时间的百分比。

- %steal：管理程序维护另一个虚拟处理器时，虚拟CPU的无意识等待时间百分比。

- %idle：CPU空闲时间百分比。


## 定时显示所有信息

### 每隔2秒刷新显示，且显示3次
```
iostat 2  3
```
### 显示指定磁盘信息
```
iostat -d /dev/sda
```
### 显示tty和Cpu信息

```
iostat -t
```
### 以M为单位显示所有信息

```
iostat -m
```

### 查看设备使用率（%util）、响应时间（await）

```
#  -d 显示磁盘使用情况，-x 显示详细信息
#  d: detail
iostat -d -x -k 1 1
```

## 查看当前开机自启动的程序

><h2>chkconfig在没有参数运行时，显示用法。如果加上服务名，那么就检查这个服务是否在当前运行级启动。如果是，返回true，否则返回false。如果在服务名后面指定了on，off或者reset，那么chkconfi 会改变指定服务的启动信息。on和off分别指服务被启动和停止，reset指重置服务的启动信息，无论有问题的初始化脚本指定了什么。on和off开关，系统默认只对运行级3，4，5有效，但是reset可以对所有运行级有效.


```
 chkconfig --list [name]   \\显示所有运行级系统服务的运行状态信息（on或off）。如果指定了name，那么只显示指定的服务在不同运行级的状态。
 ```
 ```
 chkconfig --add name      \\增加一项新的服务。chkconfig确保每个运行级有一项启动(S)或者杀死(Kill)入口。如有缺少，则会从缺省的init脚本自动建立。
 ```
 ```
chkconfig --del name       \\删除服务，并把相关符号连接从/etc/rc[0-6].d删除。
```
```
chkconfig [--level levels] name    \\设置某一服务在指定的运行级是被启动，停止还是重置。

```
### 查看系统中的脚本 

```
cd /etc/init.d/
ls
```
![](img/16.png)

### 执行开启，关闭或查看

```
./ssh  start    \\开启
```
![](img/17.png)
```
./ssh  status    \\ 查看状态
```
![](img/18.png)

```
./ssh stop    \\暂停
```
![](img/19.png)


























